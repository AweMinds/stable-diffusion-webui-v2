version: '3'

services:
  webui0:
    image: registry.cn-shanghai.aliyuncs.com/aweminds/aweminds-webui:latest-amd64
    container_name: webui0
    environment:
      START_ARGS: "--listen --logging-file-dir ./logs --logging-level DEBUG --theme dark --opt-channelslast --xformers --no-half-vae --upcast-sampling --opt-split-attention --enable-html-footer --system-monitor-addr https://aweminds.cn:8080/api/monitor --system-monitor-api-secret i7fJoi2leRvtcqVb3uLqw9Bv"
      HOST_IP: 192.168.1.152:7860
    ports:
      - "7860:7860"
    restart: on-failure
    volumes:
      - /stable-diffusion-webui/models:/app/models
      - /stable-diffusion-webui/extensions:/app/extensions
      - /stable-diffusion-webui/embeddings:/app/embeddings
      - /stable-diffusion-webui/repositories:/app/repositories
      - /stable-diffusion-webui/scripts:/app/scripts
      - /root/.cache:/root/.cache
      - /root/.ifnude:/root/.ifnude
      - /root/.insightface:/root/.insightface
      - /stable-diffusion-webui/ui-config.json:/app/ui-config.json
      - /stable-diffusion-webui/config.json:/app/config.json
      - /etc/timezone:/etc/timezone
      - /etc/localtime:/etc/localtime
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              device_ids: [ '0' ]
              capabilities: [ gpu ]

  webui1:
    image: registry.cn-shanghai.aliyuncs.com/aweminds/aweminds-webui:latest-amd64
    container_name: webui1
    environment:
      START_ARGS: "--listen --logging-file-dir ./logs --logging-level DEBUG --theme dark --opt-channelslast --xformers --no-half-vae --upcast-sampling --opt-split-attention --enable-html-footer --system-monitor-addr https://aweminds.cn:8080/api/monitor --system-monitor-api-secret i7fJoi2leRvtcqVb3uLqw9Bv"
      HOST_IP: 192.168.1.152:7861
    ports:
      - "7861:7860"
    restart: on-failure
    volumes:
      - /stable-diffusion-webui/models:/app/models
      - /stable-diffusion-webui/extensions:/app/extensions
      - /stable-diffusion-webui/embeddings:/app/embeddings
      - /stable-diffusion-webui/repositories:/app/repositories
      - /stable-diffusion-webui/scripts:/app/scripts
      - /root/.cache:/root/.cache
      - /root/.ifnude:/root/.ifnude
      - /root/.insightface:/root/.insightface
      - /stable-diffusion-webui/ui-config.json:/app/ui-config.json
      - /stable-diffusion-webui/config.json:/app/config.json
      - /etc/timezone:/etc/timezone
      - /etc/localtime:/etc/localtime
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              device_ids: [ '1' ]
              capabilities: [ gpu ]

  webui2:
    image: registry.cn-shanghai.aliyuncs.com/aweminds/aweminds-webui:latest-amd64
    container_name: webui2
    environment:
      START_ARGS: "--listen --logging-file-dir ./logs --logging-level DEBUG --theme dark --opt-channelslast --xformers --no-half-vae --upcast-sampling --opt-split-attention --enable-html-footer --system-monitor-addr https://aweminds.cn:8080/api/monitor --system-monitor-api-secret i7fJoi2leRvtcqVb3uLqw9Bv"
      HOST_IP: 192.168.1.152:7862
    ports:
      - "7862:7860"
    restart: on-failure
    volumes:
      - /stable-diffusion-webui/models:/app/models
      - /stable-diffusion-webui/extensions:/app/extensions
      - /stable-diffusion-webui/embeddings:/app/embeddings
      - /stable-diffusion-webui/repositories:/app/repositories
      - /stable-diffusion-webui/scripts:/app/scripts
      - /root/.cache:/root/.cache
      - /root/.ifnude:/root/.ifnude
      - /root/.insightface:/root/.insightface
      - /stable-diffusion-webui/ui-config.json:/app/ui-config.json
      - /stable-diffusion-webui/config.json:/app/config.json
      - /etc/timezone:/etc/timezone
      - /etc/localtime:/etc/localtime
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              device_ids: [ '2' ]
              capabilities: [ gpu ]

  webui3:
    image: registry.cn-shanghai.aliyuncs.com/aweminds/aweminds-webui:latest-amd64
    container_name: webui3
    environment:
      START_ARGS: "--listen --logging-file-dir ./logs --logging-level DEBUG --theme dark --opt-channelslast --xformers --no-half-vae --upcast-sampling --opt-split-attention --enable-html-footer --system-monitor-addr https://aweminds.cn:8080/api/monitor --system-monitor-api-secret i7fJoi2leRvtcqVb3uLqw9Bv"
      HOST_IP: 192.168.1.152:7863
    ports:
      - "7863:7860"
    restart: on-failure
    volumes:
      - /stable-diffusion-webui/models:/app/models
      - /stable-diffusion-webui/extensions:/app/extensions
      - /stable-diffusion-webui/embeddings:/app/embeddings
      - /stable-diffusion-webui/repositories:/app/repositories
      - /stable-diffusion-webui/scripts:/app/scripts
      - /root/.cache:/root/.cache
      - /root/.ifnude:/root/.ifnude
      - /root/.insightface:/root/.insightface
      - /stable-diffusion-webui/ui-config.json:/app/ui-config.json
      - /stable-diffusion-webui/config.json:/app/config.json
      - /etc/timezone:/etc/timezone
      - /etc/localtime:/etc/localtime
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              device_ids: [ '3' ]
              capabilities: [ gpu ]